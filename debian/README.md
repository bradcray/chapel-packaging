# Building Chapel Package for Debian

This directory contains the utility scripts and debian files for
building the Chapel package for Debian

## Prerequisites:

Ideally for testing, you'll want to be running a VM with the OS and
particular release you are building a package for. At the time of writing this,
we are building for Debian 9, which is currently `Debian/sid`, or 'Debian
unstable'.

This script only requires you to set 2 environment variables. If they are not
set, it will try to determine defaults:

* Set `$CHPL_RELEASE_URL` to a hosted release tarball. If that tarball is
  already present in the directory of the `build.sh` script, the script will
  not `wget` a new copy.

* Set `$DEBIAN_RELEASE` to the Debian release version name, e.g. `jessie`.

Dependencies to install prior to package building:

    sudo apt-get install build-essential python-setuptools packaging-dev libgmp-dev

## Scripts

Run the scripts with no arguments

### build.sh

Builds a .deb and .dpkg for the provided Ubuntu release (e.g. jessie) from the
unpacked release tarball of Chapel

### test.sh

Tests the package by installing it on the current machine, uninstalling it,
and generating lintian logs. Lintian logs are valuable in determining the
quality of the package.

### clean.sh

Removes any files or directories generated by any of the other scripts

### config.sh

Not executable.

Contains all the variables necessary for other scripts. See the default values
here.


## FAQ

### How do I build with pbuilder?


Install pbuilder:

```
sudo apt install pbuilder
```

Build the package with `./build.sh`


Run pbuilder on the source package:

```
cd sid/
sudo pbuilder --build chapel-1.16_1.16.0-1.dsc
```


